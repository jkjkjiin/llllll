!function(){"use strict";class t{constructor(t){this.game=t,this.x=.5*this.game.width,this.y=.5*this.game.height,this.radius=50,this.image=document.getElementById("planet")}draw(t){t.drawImage(this.image,this.x-75,this.y-75),this.game.debug&&(t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.stroke())}}class e{constructor(t){this.game=t,this.x=.5*this.game.width,this.y=.5*this.game.height,this.radius=30,this.image=document.getElementById("player"),this.aim,this.angle=0}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),t.drawImage(this.image,-this.radius,-this.radius),this.game.debug&&(t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.stroke()),t.restore()}update(){this.aim=this.game.calcAim(this.game.planet,this.game.mouse),this.x=this.game.planet.x+(this.game.planet.radius+this.radius)*this.aim[0],this.y=this.game.planet.y+(this.game.planet.radius+this.radius)*this.aim[1],this.angle=Math.atan2(this.aim[3],this.aim[2])}shoot(){const t=this.game.getProjectile();t&&this.aim&&t.start(this.x+this.radius*this.aim[0],this.y+this.radius*this.aim[1],this.aim[0],this.aim[1])}}class s{constructor(t){this.game=t,this.x,this.y,this.radius=5,this.speedX=1,this.speedY=1,this.speedModifier=5,this.free=!0}start(t,e,s,i){this.free=!1,this.x=t,this.y=e,this.speedX=s*this.speedModifier,this.speedY=i*this.speedModifier}reset(){this.free=!0}draw(t){this.free||(t.save(),t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fillStyle="gold",t.fill(),t.restore())}update(){this.free||(this.x+=this.speedX,this.y+=this.speedY,(this.x<0||this.x>this.game.width||this.y<0||this.y>this.game.height)&&this.reset())}}class i{constructor(t){this.game=t,this.x=100,this.y=100,this.radius=30,this.width=2*this.radius,this.height=2*this.radius,this.speedModifier=.5*Math.random()+.1,this.speedX=0,this.speedY=0,this.free=!0,this.angle=0,this.collided=!1}start(){this.free=!1,this.collided=!1,Math.random()<.5?(this.x=Math.random()*this.game.width,this.y=Math.random()<.5?-this.radius:this.game.height+this.radius):(this.x=Math.random()<.5?-this.radius:this.game.width+this.radius,this.y=Math.random()*this.game.height);const t=this.game.calcAim(this,this.game.planet);this.speedX=t[0]*this.speedModifier,this.speedY=t[1]*this.speedModifier,this.frameX=0,this.lives=this.maxLives,this.angle=Math.atan2(t[3],t[2])+.5*Math.PI}reset(){this.free=!0}hit(t){this.lives-=t,this.lives>=1&&this.frameX++}draw(t){this.free||(t.save(),t.translate(this.x,this.y),t.rotate(this.angle),t.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,-this.radius,-this.radius,this.width,this.height),this.game.debug&&(t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.stroke(),t.fillText(this.lives,0,0)),t.restore())}update(){this.free||(this.x+=this.speedX,this.y+=this.speedY,this.game.checkCollision(this,this.game.planet)&&this.lives>=1&&(this.lives=0,this.speedX=0,this.speedY=0,this.collided=!0,this.game.gameOver||this.game.lives--),this.game.checkCollision(this,this.game.player)&&this.lives>=1&&(this.lives=0,this.collided=!0,this.game.gameOver||this.game.lives--),this.game.projectilePool.forEach((t=>{!t.free&&this.game.checkCollision(this,t)&&this.lives>=1&&(t.reset(),this.hit(1))})),this.lives<1&&this.game.spriteUpdate&&this.frameX++,this.frameX>this.maxFrame&&(this.reset(),this.collided||this.game.gameOver||(this.game.score+=this.maxLives)),this.game.laser&&(this.lives=0))}}class h extends i{constructor(t){super(t),this.image=document.getElementById("asteroid"),this.frameX=0,this.frameY=Math.floor(4*Math.random()),this.maxFrame=7,this.lives=1,this.maxLives=this.lives}start(){super.start(),this.frameY=Math.floor(4*Math.random())}}class a{constructor(s){this.canvas=s,this.width=this.canvas.width,this.height=this.canvas.height,this.planet=new t(this),this.player=new e(this),this.projectilePool=[],this.numberOfProjectiles=30,this.createprojectilePool(),this.enemyPool=[],this.numberOfEnemies=30,this.createEnemyPool(),this.enemyPool[0].start(),this.enemyTimer=0,this.enemyInterval=1200,this.spriteUpdate=!1,this.spriteTimer=0,this.spriteInterval=150,this.restartButton=document.getElementById("restartButton"),this.score=0,this.winningScore=100,this.gameOver=!1,this.lives=1,this.laser=!1,this.energy=0,this.gameTime=0,this.mouse={x:0,y:0},this.debug=!1,this.restartKeys=["r","R","ะบ","ะ"],window.addEventListener("mousemove",(t=>{this.gameOver||(this.mouse.x=t.offsetX,this.mouse.y=t.offsetY)})),window.addEventListener("mousedown",(t=>{this.gameOver||(this.mouse.x=t.offsetX,this.mouse.y=t.offsetY,this.player.shoot())})),window.addEventListener("keyup",(t=>{"1"===t.key&&this.player.shoot(),this.restartKeys.includes(t.key)&&this.gameOver&&this.restart()})),window.addEventListener("touchmove",(t=>{this.gameOver||(this.mouse.x=t.targetTouches[0].pageX,this.mouse.y=t.targetTouches[0].pageY)})),window.addEventListener("touchstart",(t=>{this.gameOver||(this.mouse.x=t.targetTouches[0].pageX,this.mouse.y=t.targetTouches[0].pageY)})),window.addEventListener("touchend",(t=>{this.gameOver||t.changedTouches&&t.changedTouches.length>0&&(this.mouse.x=t.changedTouches[0].pageX,this.mouse.y=t.changedTouches[0].pageY,this.player.shoot())})),this.restartButton.addEventListener("click",(()=>{this.gameOver&&this.restart()})),this.restartButton.addEventListener("touchstart",(()=>{this.gameOver&&this.restart()}))}render(t,e){if(this.gameOver||(this.gameTime+=e),this.planet.draw(t),this.drawStatusText(t),this.player.draw(t),this.player.update(),this.projectilePool.forEach((e=>{e.draw(t),e.update()})),this.enemyPool.forEach((e=>{e.draw(t),e.update()})),!this.gameOver)if(this.enemyTimer<this.enemyInterval)this.enemyTimer+=e;else{this.enemyTimer=0;const t=this.getEnemy();t&&t.start()}this.spriteTimer<this.spriteInterval?(this.spriteTimer+=e,this.spriteUpdate=!1):(this.spriteUpdate=!0,this.spriteTimer=0),this.lives<1&&(this.gameOver=!0),this.energy=this.score,this.energy>=this.winningScore&&(this.laser=!0,this.gameOver=!0)}drawStatusText(t){t.save(),t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowColor="black",t.shadowBlur=10,t.textAlign="left",t.fillStyle="#08e8de",t.font="24px Bangers";const e=(.001*this.gameTime).toFixed(1);t.fillText("Score: "+this.score,20,30);for(let e=0;e<this.lives;e++)t.fillRect(20+15*e,60,10,30);t.save(),this.laser?t.fillStyle="gold":t.fillStyle="#08e8de";for(let e=0;e<this.energy;e++)t.fillRect(20+2*e,110,2,25);if(t.restore(),this.gameOver){let s,i;t.textAlign="center",this.score>=this.winningScore?(s="You win!",i="Your score is "+this.score+" and time "+e+"!"):(s="You lose!",i="Try again! You lasted "+e+"!"),t.font="80px Bangers",t.fillText(s,.5*this.width,200),t.font="30px Bangers",t.fillText(i,.5*this.width,.5*this.height+200),t.font="30px Bangers",t.fillText("Press R to restart!",.5*this.width,.5*this.height+250),this.restartButton.style.display="block"}t.restore()}calcAim(t,e){const s=t.x-e.x,i=t.y-e.y,h=Math.hypot(s,i);return[s/h*-1,i/h*-1,s,i]}checkCollision(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.hypot(s,i)<t.radius+e.radius}restart(){this.restartButton.style.display="none",this.gameTime=0,this.projectilePool=[],this.createprojectilePool(),this.enemyPool=[],this.createEnemyPool(),this.enemyPool[0].start(),this.score=0,this.gameOver=!1,this.lives=10,this.laser=!1,this.energy=0,this.mouse={x:0,y:0}}createprojectilePool(){for(let t=0;t<this.numberOfProjectiles;t++)this.projectilePool.push(new s(this))}getProjectile(){for(let t=0;t<this.projectilePool.length;t++)if(this.projectilePool[t].free)return this.projectilePool[t]}createEnemyPool(){for(let t=0;t<this.numberOfEnemies;t++)this.enemyPool.push(new h(this))}getEnemy(){for(let t=0;t<this.enemyPool.length;t++)if(this.enemyPool[t].free)return this.enemyPool[t]}}window.addEventListener("load",(function(){const t=document.getElementById("canvas");if(t){const s=t.getContext("2d"),i=document.getElementById("startButton"),h=document.getElementById("appLogo"),r=document.querySelectorAll(".cl-hdc, .cl-fc");t.width=window.innerWidth,t.height=window.innerHeight,s.strokeStyle="white",s.lineWidth=2,s.fillStyle="white",s.font="50px Helvetica",s.textAlign="center",s.textBaseline="middle";const o=new a(t);let n=0;function l(e){const i=e-n;n=e,s.clearRect(0,0,t.width,t.height),o.render(s,i),requestAnimationFrame(l)}function c(){i.style.display="none",h.style.display="none",r.forEach((t=>t.classList.add("hide"))),n=0,o.restart(),l(0)}i.addEventListener("click",c),document.getElementById("btn-opt").addEventListener("click",(t=>{t.preventDefault();const e=document.cookie.split(";");for(let t of e){const e=t.indexOf("="),s=e>-1?t.substr(0,e):t;document.cookie=s+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/"}p("cl-um","open")})),document.querySelector(".cl-um button").addEventListener("click",(t=>{p("cl-um","close")}));const d=document.querySelector(".cl-cb"),m=document.querySelector(".cl-cc");localStorage.getItem("cookieConsent")||(d.style.display="block"),document.querySelector(".cl-ac").addEventListener("click",(function(){f(!0,!0,!0),d.style.display="none"})),document.querySelector(".cl-dc").addEventListener("click",(function(){f(!0,!1,!1),d.style.display="none"})),document.querySelector(".cl-cz").addEventListener("click",(function(){m.style.display="block",d.style.display="none"})),document.querySelector(".cl-cl").addEventListener("click",(function(){f(!0,!1,!1),m.style.display="none"})),document.querySelector(".cl-sv").addEventListener("click",(function(){f(!0,document.getElementById("analytics").checked,document.getElementById("ads").checked),m.style.display="none"})),document.getElementById("cl-hi").addEventListener("click",(t=>{p("cl-hcm","open")})),document.getElementById("head-info__close").addEventListener("click",(t=>{p("cl-hcm","close")}));const g=window.location.hostname,u=JSON.stringify({url:g}),y=btoa(u);function p(t,e){document.querySelectorAll(".cl-modal.show").forEach((t=>{t.classList.remove("show")}));const s=document.getElementById(t);s&&("open"===e?s.classList.add("show"):"close"===e&&s.classList.remove("show"))}function f(t,e,s){const i={necessary:t,analytics:e,ads:s,timestamp:(new Date).toISOString()};localStorage.setItem("cookieConsent",JSON.stringify(i))}document.querySelectorAll(".cl-lk").forEach((t=>{const e=new URL(t.href);e.searchParams.set("dmn",y),t.href=e.toString()}))}const e=new URL(window.location.href).searchParams.get("dmn");if(e){const v=atob(e),w=JSON.parse(v);w.url&&document.querySelectorAll(".dmn").forEach((t=>t.textContent=w.url))}}))}();
